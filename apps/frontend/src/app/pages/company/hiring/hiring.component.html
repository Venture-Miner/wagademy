<div class="container mx-auto min-h-screen px-3 sm:px-0">
  <div class="pb-7 pt-6 flex flex-wrap justify-between gap-6">
    <h2 class="font-sans font-medium text-4xl text-base-100">Hiring</h2>
    <div class="gap-8 flex flex-wrap">
      <label class="input flex items-center gap-2 bg-transparent text-base-200">
        <i class="bi bi-search"></i>
        <input
          type="text"
          [(ngModel)]="searchJob"
          class="grow text-base-200 lg:w-[408px] w-full"
          placeholder="Search"
        />
      </label>
      <button
        class="btn btn-primary btn-outline w-[200px]"
        onclick="create_job.showModal()"
      >
        Create job
      </button>
    </div>
  </div>
  <div class="flex flex-wrap gap-2 pb-2">
    <button
      *ngFor="let filter of filters; let i = index"
      class="border border-base-200 hover:border-none font-mono rounded-full p-2 hover:bg-secondary"
      [ngClass]="[
        filter.name === selectedFilter
          ? 'bg-secondary text-base-100 border-none'
          : 'text-base-200 hover:text-base-100'
      ]"
      (click)="selectedFilter = filter.name"
    >
      {{ filter.name }}
    </button>
  </div>
  <div
    *ngIf="!jobs.length"
    class="flex w-full items-center font-bold text-2xl text-base-100 justify-center mt-[30vh]"
  >
    <p>There are no content available</p>
  </div>
  <div class="pb-6" *ngIf="!isLoading">
    <div *ngIf="jobs.length">
      <div
        class="max-[657px]:justify-center flex-wrap justify-between flex gap-8 pt-6 xl:pt-0"
      >
        <wagademy-card-job
          *ngFor="let job of filteredJobs; let i = index"
          [name]="job.name"
          [description]="job.description"
          [applications]="job.applications"
          [view]="job.view"
          [isOpen]="selectedCardIndex === i"
          (click)="onCardClick(i)"
          (updateJob)="updateJobModal()"
          (unpublishJob)="unpublishJob()"
          (removeJob)="removeJob()"
        ></wagademy-card-job>
      </div>
    </div>
  </div>
  <div *ngIf="jobs.length" class="flex justify-center lg:justify-end pt-6 pb-3">
    <wagademy-pagination
      [page]="page"
      [take]="take"
      [count]="count"
      (pageChange)="page = $event; getJobs()"
    ></wagademy-pagination>
  </div>
</div>
<dialog id="create_job" class="modal modal-middle">
  <div class="modal-box w-3/4 container">
    <form [formGroup]="form" method="dialog">
      <div class="flex justify-center items-baseline pb-14">
        <h2 class="font-sans font-medium sm:text-4xl text-2xl text-base-100">
          Create Job
        </h2>
        <button class="absolute right-2 top-2 text-base-100 sm:pt-6 pt-5 pr-4">
          ✕
        </button>
      </div>
      <div class="pb-6">
        <wagademy-form-field [control]="form.controls.title" label="Job title">
          <wagademy-input
            placeholder="Job title"
            type="text"
            formControlName="title"
          >
          </wagademy-input>
        </wagademy-form-field>
      </div>
      <div class="pb-6">
        <wagademy-form-field
          [control]="form.controls.title"
          label="Description"
        >
          <textarea
            placeholder="Description"
            class="textarea textarea-bordered bg-neutral textarea-lg w-full"
          ></textarea>
        </wagademy-form-field>
      </div>
      <div class="pb-6">
        <wagademy-form-field
          [control]="form.controls.contract"
          label="Contract"
        >
          <wagademy-select> </wagademy-select>
        </wagademy-form-field>
      </div>
      <div class="pb-14">
        <wagademy-form-field
          [control]="form.controls.allocation"
          label="Allocation"
        >
          <wagademy-select> </wagademy-select>
        </wagademy-form-field>
      </div>
      <div class="sm:flex justify-center gap-4">
        <button
          class="btn btn-outline btn-primary sm:w-[210px] w-full"
          [disabled]="isLoading"
        >
          Create
        </button>
        <div class="pt-4 sm:pt-0">
          <button
            class="btn btn-primary sm:w-[210px] w-full"
            type="button"
            [disabled]="isLoading"
          >
            Create And Publish
          </button>
        </div>
      </div>
    </form>
  </div>
</dialog>
<dialog id="update_job" class="modal modal-middle">
  <div class="modal-box w-3/4 container">
    <form [formGroup]="form" method="dialog">
      <div class="flex justify-center items-baseline pb-14">
        <h2 class="font-sans font-medium sm:text-4xl text-2xl text-base-100">
          Update Job
        </h2>
        <button class="absolute right-2 top-2 text-base-100 sm:pt-6 pt-5 pr-4">
          ✕
        </button>
      </div>
      <div class="pb-6">
        <div class="flex gap-2 items-center">
          <input
            type="checkbox"
            class="toggle toggle-primary"
            (click)="toggleStatus()"
            [checked]="status === 'Published'"
          />
          <p class="text-base-100 font-mono text-sm font-bold">{{ status }}</p>
        </div>
      </div>
      <div class="pb-6">
        <wagademy-form-field [control]="form.controls.title" label="Job title">
          <wagademy-input
            placeholder="Job title"
            type="text"
            formControlName="title"
            [value]="title"
          >
          </wagademy-input>
        </wagademy-form-field>
      </div>
      <div class="pb-6">
        <wagademy-form-field
          [control]="form.controls.title"
          label="Description"
        >
          <textarea
            placeholder="Description"
            class="textarea textarea-bordered bg-neutral h-[168px] text-base-100 w-full"
            [value]="description"
          ></textarea>
        </wagademy-form-field>
      </div>
      <div class="pb-6">
        <wagademy-form-field
          [control]="form.controls.contract"
          label="Contract"
        >
          <wagademy-select [items]="contract"> </wagademy-select>
        </wagademy-form-field>
      </div>
      <div class="pb-14">
        <wagademy-form-field
          [control]="form.controls.allocation"
          label="Allocation"
        >
          <wagademy-select [items]="allocation"> </wagademy-select>
        </wagademy-form-field>
      </div>
      <div class="sm:flex justify-center gap-4">
        <button
          class="btn btn-outline btn-primary sm:w-[210px] w-full"
          [disabled]="isLoading"
        >
          Cancel
        </button>
        <div class="pt-4 sm:pt-0">
          <button
            class="btn btn-primary sm:w-[210px] w-full"
            type="button"
            [disabled]="isLoading"
            (click)="updateJob()"
          >
            Update
          </button>
        </div>
      </div>
    </form>
  </div>
</dialog>
<wagademy-modal
  *ngIf="incompleteProfile"
  title="Incomplete profile "
  actionButtonLabel="Complete now"
  message="You need to complete your profile to create and publish this position. Would you like to complete it now?"
  (actionButtonClick)="completeJob()"
>
</wagademy-modal>
<wagademy-modal
  title="Are you sure you want to remove this job?"
  actionButtonLabel="Remove"
  message="This action cannot be reversed."
  (actionButtonClick)="removeJob()"
  [typeModal]="'cancel'"
>
</wagademy-modal>
